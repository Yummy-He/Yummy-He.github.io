---
title: Archive
layout: default
description: "「我干了什么 究竟拿了时间换了什么」"
header-img: "img/bg-little-universe.jpg"
---

<!--
Credits: this page shamelessly borrowed a lot from:
https://github.com/kitian616/jekyll-TeXt-theme
-->
<!-- Page Header -->
{% include intro-header.html type='page' short=true %}

<!-- Main Content -->
<div class="container">
	<div class="row">
		<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
			<!-- Tags (as filter) -->
			<div id='tag_cloud' class="tags tags-sup js-tags">
                <!-- 先筛选符合条件的文章和项目 -->
				{% assign filtered_posts = site.posts 
					| where_exp: "post", "post.hidden != true" 
					| where_exp: "post", "post.published != false" %}
				{% assign filtered_projects = site.pages 
					| where: "layout", "project-item" 
					| where_exp: "item", "item.hidden != true" 
					| where_exp: "item", "item.published != false" 
					| sort: 'title' %}

				<!-- 计算总数量（筛选后） -->
				{% assign total_posts = filtered_posts.size %}
				{% assign total_projects = filtered_projects.size %}
				{% assign total_items = total_posts | plus: total_projects %}
				<a class="tag-button--all" data-encode="">
					Show All
					<sup>{{ total_items }}</sup>
				</a>

                <!-- 步骤1：收集所有标签（从筛选后的文章+项目）到数组 -->
				{% assign all_tag_array = '' | split: '' %}
				<!-- 收集文章标签 -->
				{% for post in filtered_posts %}
					{% for tag in post.tags %}
						{% assign all_tag_array = all_tag_array | push: tag %}
					{% endfor %}
				{% endfor %}
				<!-- 收集项目标签 -->
				{% for item in filtered_projects %}
					{% for tag in item.tags %}
						{% assign all_tag_array = all_tag_array | push: tag %}
					{% endfor %}
				{% endfor %}

                <!-- 步骤2：对标签数组去重并统计数量 -->
				{% assign unique_tags = all_tag_array | uniq | sort %}
				{% capture sorted_tags %}
				{% for tag in unique_tags %}
					{% assign tag_count = 0 %}
					{% for t in all_tag_array %}
						{% if t == tag %}
							{% assign tag_count = tag_count | plus: 1 %}
						{% endif %}
					{% endfor %}
					<a data-sort="{{ total_items | minus: tag_count | prepend: '0000' | slice: -4, 4 }}"
					   data-encode="{{ tag | strip | url_encode }}" class="tag-button" title="{{ tag }}"
					   rel="{{ tag_count }}">
						{{ tag }}
						<sup>{{ tag_count }}</sup>
					</a>__SEPERATOR__
				{% endfor %}
				{% endcapture %}
				{{ sorted_tags | split:'__SEPERATOR__' | reject: '' }}
			</div>

			<!-- Article List -->
			<div class="mini-post-list js-result d-none">
                {% comment %} 1. 置顶展示 Project 分组（使用筛选后的项目） {% endcomment %}
				{% if filtered_projects.size > 0 %}
				<section>
					<span class="fa listing-seperator">
						<span class="tag-text">Project</span>
					</span>
					{% for _item in filtered_projects %}
					{%- assign _tags = '' -%}
					{%- for _tag in _item.tags -%}
					{%- assign _tag_encode = _tag | strip | url_encode -%}
					{%- if forloop.last -%}
					{%- assign _tags = _tags | append: _tag_encode -%}
					{%- else -%}
					{%- assign _tags = _tags | append: _tag_encode | append: ',' -%}
					{%- endif -%}
					{%- endfor -%}
					<div class="post-preview item" data-tags="{{ _tags }}">
						<a href="{{ _item.url | prepend: site.baseurl }}">
							<h2 class="post-title">
								{{ _item.title }}
							</h2>
							{% if _item.subtitle %}
							<h3 class="post-subtitle">
								{{ _item.subtitle }}
							</h3>
							{% endif %}
						</a>
						<hr>
					</div>
					{% endfor %}
				</section>
				{% endif %}

                {% comment %} 2. 展示原有按年份分组的文章（使用筛选后的文章） {% endcomment %}
				{%- assign _sorted_list = filtered_posts | sort: 'date' | reverse -%}
				{%- assign _date = '' -%}
				{%- for _article in _sorted_list -%}
				{%- assign _tags = '' -%}
				{%- for _tag in _article.tags -%}
				{%- assign _tag_encode = _tag | strip | url_encode -%}
				{%- if forloop.last -%}
				{%- assign _tags = _tags | append: _tag_encode -%}
				{%- else -%}
				{%- assign _tags = _tags | append: _tag_encode | append: ',' -%}
				{%- endif -%}
				{%- endfor -%}

				{% comment %} group by year {% endcomment %}
				{%- assign _currentdate = _article.date | date: '%Y' -%}
				{%- if _currentdate != _date -%}
				{%- unless forloop.first -%}</section>{%- endunless -%}
				<section>
					<span class="fa listing-seperator">
						<span class="tag-text">{{ _currentdate }}</span>
					</span>
					{%- assign _date = _currentdate -%}
				{%- endif -%}

				<div class="post-preview item" data-tags="{{ _tags }}">
					<a href="{{ _article.url | prepend: site.baseurl }}">
						<h2 class="post-title">
							{{ _article.title }}
						</h2>
						{% if _article.subtitle %}
						<h3 class="post-subtitle">
							{{ _article.subtitle }}
						</h3>
						{% endif %}
					</a>
					<hr>
				</div>
				{%- if forloop.last -%}
				</section>{%- endif -%}
				{% endfor %}
			</div>
		</div>
	</div>
</div>